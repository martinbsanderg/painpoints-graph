{"ast":null,"code":"import _defineProperty from\"/Users/martinbsandberg/Documents/GitHub/painpoints-graph/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/martinbsandberg/Documents/GitHub/painpoints-graph/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/martinbsandberg/Documents/GitHub/painpoints-graph/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useCallback,useEffect}from\"react\";import{Controls,Background,applyNodeChanges,applyEdgeChanges,addEdge}from\"reactflow\";import\"reactflow/dist/style.css\";import{darkTheme}from\"../../theme.jsx\";import{initialNodes}from\"../node.components.jsx\";import{initialEdges}from\"../edges.component\";import{CustomNode}from\"../custom-nodes/custom-node.component.jsx\";import{StyledFlow,MiniMapStyled}from\"./flow.styles\";import{CustomEdge}from\"../custom-edges/custom-edges.component.jsx\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var nodeTypes={highLevelNode:CustomNode,specificLevelNode:CustomNode,consequenceNode:CustomNode};var edgeTypes={custom:CustomEdge};var Flow=function Flow(props){var _useState=useState(initialNodes),_useState2=_slicedToArray(_useState,2),nodes=_useState2[0],setNodes=_useState2[1];var _useState3=useState(initialEdges),_useState4=_slicedToArray(_useState3,2),edges=_useState4[0],setEdges=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),anySelected=_useState6[0],setAnySelected=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),relatedNodes=_useState8[0],setRelatedNodes=_useState8[1];var onNodesChange=useCallback(function(changes){return setNodes(function(nds){var selected=changes.filter(function(node){return node.selected===true;});if(selected.length>=1){setAnySelected(selected);setRelatedNodes(function(){return[];});}else{setAnySelected(function(){return false;});setRelatedNodes(function(){return[];});}return applyNodeChanges(changes,nds);});},[]);useEffect(function(){setNodes(function(nds){return nds.map(function(node){anySelected?node.data.anySelected=true:node.data.anySelected=false;return node;});});return;},[anySelected]);useEffect(function(){setEdges(function(edgs){return edgs.map(function(edge){if(!anySelected){return _objectSpread(_objectSpread({},edge),{},{data:{anySelected:false,connectedToSelected:false}});}var selectedNode=anySelected[0].id;if(edge.target===selectedNode||edge.source===selectedNode){setRelatedNodes(function(prev){var newValue=edge.target===selectedNode?edge.source:edge.target;return _objectSpread(_objectSpread({},prev),{},_defineProperty({},newValue,newValue));});return _objectSpread(_objectSpread({},edge),{},{data:{anySelected:true,connectedToSelected:true}});}else{return _objectSpread(_objectSpread({},edge),{},{data:{anySelected:true,connectedToSelected:false}});}});});},[anySelected]);useEffect(function(){setNodes(function(nds){return nds.map(function(node){if(relatedNodes[node.id]){return _objectSpread(_objectSpread({},node),{},{data:_objectSpread(_objectSpread({},node.data),{},{relatedToSelected:true})});}return _objectSpread(_objectSpread({},node),{},{data:_objectSpread(_objectSpread({},node.data),{},{relatedToSelected:false})});});});},[relatedNodes,anySelected]);var onEdgesChange=useCallback(function(changes){return setEdges(function(eds){return applyEdgeChanges(changes,eds);});},[]);return/*#__PURE__*/_jsxs(StyledFlow,{nodes:nodes,onNodesChange:onNodesChange,edges:edges,onEdgesChange:onEdgesChange,nodeTypes:nodeTypes,edgeTypes:edgeTypes,fitView:true,children:[/*#__PURE__*/_jsx(Background,{}),/*#__PURE__*/_jsx(Controls,{}),/*#__PURE__*/_jsx(MiniMapStyled,{zoomable:true,pannable:true,nodeColor:function nodeColor(_ref){var type=_ref.type;return darkTheme[type].bgC;}})]});};export default Flow;","map":{"version":3,"names":["useState","useCallback","useEffect","Controls","Background","applyNodeChanges","applyEdgeChanges","addEdge","darkTheme","initialNodes","initialEdges","CustomNode","StyledFlow","MiniMapStyled","CustomEdge","jsx","_jsx","jsxs","_jsxs","nodeTypes","highLevelNode","specificLevelNode","consequenceNode","edgeTypes","custom","Flow","props","_useState","_useState2","_slicedToArray","nodes","setNodes","_useState3","_useState4","edges","setEdges","_useState5","_useState6","anySelected","setAnySelected","_useState7","_useState8","relatedNodes","setRelatedNodes","onNodesChange","changes","nds","selected","filter","node","length","map","data","edgs","edge","_objectSpread","connectedToSelected","selectedNode","id","target","source","prev","newValue","_defineProperty","relatedToSelected","onEdgesChange","eds","fitView","children","zoomable","pannable","nodeColor","_ref","type","bgC"],"sources":["/Users/martinbsandberg/Documents/GitHub/painpoints-graph/src/components/flow/flow.component.jsx"],"sourcesContent":["import { useState, useCallback, useEffect } from \"react\";\nimport {\n  Controls,\n  Background,\n  applyNodeChanges,\n  applyEdgeChanges,\n  addEdge,\n} from \"reactflow\";\nimport \"reactflow/dist/style.css\";\nimport { darkTheme } from \"../../theme.jsx\";\nimport { initialNodes } from \"../node.components.jsx\";\nimport { initialEdges } from \"../edges.component\";\nimport { CustomNode } from \"../custom-nodes/custom-node.component.jsx\";\nimport { StyledFlow, MiniMapStyled } from \"./flow.styles\";\nimport { CustomEdge } from \"../custom-edges/custom-edges.component.jsx\";\n\nconst nodeTypes = {\n  highLevelNode: CustomNode,\n  specificLevelNode: CustomNode,\n  consequenceNode: CustomNode,\n};\n\nconst edgeTypes = {\n  custom: CustomEdge,\n};\n\nconst Flow = (props) => {\n  const [nodes, setNodes] = useState(initialNodes);\n  const [edges, setEdges] = useState(initialEdges);\n  const [anySelected, setAnySelected] = useState(false);\n  const [relatedNodes, setRelatedNodes] = useState({});\n\n  const onNodesChange = useCallback(\n    (changes) =>\n      setNodes((nds) => {\n        const selected = changes.filter((node) => node.selected === true);\n        if (selected.length >= 1) {\n          setAnySelected(selected);\n          setRelatedNodes(() => []);\n        } else {\n          setAnySelected(() => false);\n          setRelatedNodes(() => []);\n        }\n        return applyNodeChanges(changes, nds);\n      }),\n    []\n  );\n\n  useEffect(() => {\n    setNodes((nds) =>\n      nds.map((node) => {\n        anySelected\n          ? (node.data.anySelected = true)\n          : (node.data.anySelected = false);\n        return node;\n      })\n    );\n    return;\n  }, [anySelected]);\n\n  useEffect(() => {\n    setEdges((edgs) => {\n      return edgs.map((edge) => {\n        if (!anySelected) {\n          return {\n            ...edge,\n            data: { anySelected: false, connectedToSelected: false },\n          };\n        }\n        const selectedNode = anySelected[0].id;\n\n        if (edge.target === selectedNode || edge.source === selectedNode) {\n          setRelatedNodes((prev) => {\n            const newValue =\n              edge.target === selectedNode ? edge.source : edge.target;\n            return {...prev, [newValue]:newValue};\n          });\n\n          return {\n            ...edge,\n            data: { anySelected: true, connectedToSelected: true },\n          };\n        } else {\n          return {\n            ...edge,\n            data: { anySelected: true, connectedToSelected: false },\n          };\n        }\n      });\n    });\n  }, [anySelected]);\n\n  useEffect(() => {\n    setNodes((nds) =>\n      nds.map((node) => {\n        if (relatedNodes[node.id]) {\n          return { ...node, data: { ...node.data, relatedToSelected: true } };\n        }\n        return { ...node, data: { ...node.data, relatedToSelected: false } };\n      })\n    );\n  }, [relatedNodes, anySelected]);\n\n  const onEdgesChange = useCallback(\n    (changes) => setEdges((eds) => applyEdgeChanges(changes, eds)),\n    []\n  );\n\n  return (\n    <StyledFlow\n      nodes={nodes}\n      onNodesChange={onNodesChange}\n      edges={edges}\n      onEdgesChange={onEdgesChange}\n      nodeTypes={nodeTypes}\n      edgeTypes={edgeTypes}\n      fitView\n    >\n      <Background />\n      <Controls />\n      <MiniMapStyled\n        zoomable\n        pannable\n        nodeColor={({ type }) => darkTheme[type].bgC}\n      />\n    </StyledFlow>\n  );\n};\n\nexport default Flow;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}